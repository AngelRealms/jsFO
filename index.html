<html>
<head>

	<title>jsFallout</title>
	<link rel="icon" href="inc/favicon.ico"/>
	<link href='http://fonts.googleapis.com/css?family=Oswald' rel='stylesheet' type='text/css'>
	<link rel="stylesheet" href="inc/main.css"/>

	<script src="src/renderer.js"></script>
	<script src="src/assets.js"></script>
	<script src="src/browser.js"></script>
	<script src="src/bitmapFont.js"></script>
	<script src="src/mapObjects.js"></script>
	<script src="src/global.js"></script>
	<script src="src/GameState.js"></script>
	<script src="src/GameMap.js"></script>
	<script src="src/MainState.js"></script>
	<script src="src/newGame.js"></script>
	<script src="src/MainState_obj.js"></script>
	<script src="src/LoadState.js"></script>
	<script src="src/MainLoadState.js"></script>
	<script src="src/SkilldexState.js"></script>
	<script src="src/ContextMenuState.js"></script>
	<script src="src/MainMenuState.js"></script>
	<script src="src/IngameMenuState.js"></script>
	<script src="src/InventoryState.js"></script>
	<script src="src/CharacterScreenState.js"></script>
	<script src="src/PipboyState.js"></script>
	<script src="src/MapscreenState.js"></script>
	<script src="src/vm.js"></script>
	<script src="src/vm_op.js"></script>

	<script src="src/main.js"></script>
	<script src="src/main_gl.js"></script>

	<script src="http://greggman.github.com/webgl-fundamentals/webgl/resources/webgl-utils.js"></script>
	<script id="vshader" type="x-shader/x-fragment">
		attribute vec4 a_position;
		varying vec2 v_texcoord;
		void main() {
			gl_Position = a_position;
			v_texcoord = a_position.xy * vec2(0.5, -0.5) + 0.5;
		}
	</script>

	<script id="fshader" type="x-shader/x-fragment">
		precision mediump float;
		varying vec2 v_texcoord;
		uniform sampler2D u_image;
		uniform sampler2D u_palette;

		void main() {
			float index = texture2D(u_image, v_texcoord).a;
			gl_FragColor = texture2D(u_palette, vec2(index, 0.5));
		}
	</script>


	<script>

		var mainState_prevState;	// track previous state of mainState.statePause

		// Page functions
		function openInfo() {
			mainState_prevState = mainState.statePause;
			mainState.statePause = true;
			document.getElementById('lightbox').style.display = 'block';
			document.getElementById('info').style.display = 'block';
		};

		function openHelp() {
			mainState_prevState = mainState.statePause;
			mainState.statePause = true;
			document.getElementById('lightbox').style.display = 'block';
			document.getElementById('help').style.display = 'block';
		};

		function closeWindows() {
			mainState.statePause = mainState_prevState;
			document.getElementById('lightbox').style.display = 'none';
			document.getElementById('info').style.display = 'none';
			document.getElementById('help').style.display = 'none';
		};

		function browserTestFail() {
			document.getElementById("mainCanvas").style.display = 'none';
			document.getElementById("main_failed").style.display = 'block';
		};

	</script>

</head>

<!--Entry point defined as window.addEventListener("load", main_init); in main.js -->
<body>
	<div id="main">
		<div id="main_header">
			<img src="inc/main_topLogo.png"/>
			<div id="main_header_info">
				<a href="#" onclick="openInfo()">Info</a>
				<a href="#" onclick="openHelp()">Help</a>
				<a href="https://github.com/ajxs/jsFO" target="_blank">Github</a>
			</div>
		</div>
		<canvas id="mainCanvas" oncontextmenu="javascript: return false;"></canvas>
		<div id="main_failed" style="display: none">
			<img src="inc/main_failed.png"/>
		</div>
	</div>

	<div id="mainStorage">
		<img id="mse_overlay" src="inc/mse_overlay.gif"/>
		<img id="mse_overlay_blocked" src="inc/mse_overlay_blocked.gif"/>
		<img id="trans_egg" src="inc/egg.png"/>
		<img id="loadState_overlay" src="inc/loadState_overlay.png"/>
		<img id="MainMenuState_bg" src="inc/MainMenuState_bg.png"/>
		<img id="MainMenuState_btn" src="inc/MainMenuState_btn.png"/>
		<img id="MainLoadState_bg" src="inc/MainLoadState_bg.png"/>
	</div>
	<div id="lightbox" style="display: none" onclick="closeWindows()"></div>
	<div id="info" class="infoBox" style="display: none">
		<div class="infoHeading">jsFO / Info</div>
		jsFO is an open-source port of Interplay's Fallout2 for the browser, written in Javascript, with conversion of assets from the original Fallout2 handled in Python. jsFO uses the HTML5 canvas API for rendering, and should be compatible with all modern browsers.</br>
		For more information, as well as access to the source-code, head over to the project's <a href="https://github.com/ajxs/jsFO/">Github Page</a>.
	</div>
	<div id="help" class="infoBox" style="display: none">
		<div class="infoHeading">jsFO / Help</div>
		All controls and functionality idential to the original Fallout2.</br>
		Please report any bugs to: <a href="mailto:ajxscc@gmail.com">ajxscc@gmail.com</a>
	</div>
</body>
